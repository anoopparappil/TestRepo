Modified from git new1